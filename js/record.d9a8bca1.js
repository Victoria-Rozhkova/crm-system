(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["record"],{"43ef":function(e,t,c){"use strict";c.r(t);var o=c("7a23");const n={class:"page-title"},i={key:1,class:"center"},l={class:"input-field"},a=["value"],r={class:"input-field"},s={for:"amount"},d={key:0,class:"helper-text invalid"},b={class:"input-field"},m={for:"description"},u={key:0,class:"helper-text invalid"},p={class:"btn waves-effect waves-light",type:"submit"},O=Object(o["createElementVNode"])("i",{class:"material-icons right"},"send",-1);function j(e,t,c,j,h,g){const y=Object(o["resolveComponent"])("Loader"),v=Object(o["resolveComponent"])("router-link");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("div",n,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.$t("newRecord.title")),1)]),h.loading?(Object(o["openBlock"])(),Object(o["createBlock"])(y,{key:0})):h.categories.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("form",{key:2,class:"form",onSubmit:t[5]||(t[5]=Object(o["withModifiers"])((...e)=>g.onSubmit&&g.onSubmit(...e),["prevent"]))},[Object(o["createElementVNode"])("div",l,[Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{ref:"select","onUpdate:modelValue":t[0]||(t[0]=e=>h.category=e)},[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(h.categories,e=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:e.id,value:e.id},Object(o["toDisplayString"])(e.title),9,a))),128))],512),[[o["vModelSelect"],h.category]]),Object(o["createElementVNode"])("label",null,Object(o["toDisplayString"])(e.$t("newRecord.categoryLabel")),1)]),Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("label",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"with-gap",name:"type",type:"radio",value:"income","onUpdate:modelValue":t[1]||(t[1]=e=>h.type=e)},null,512),[[o["vModelRadio"],h.type]]),Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(e.$t("common.income")),1)])]),Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("label",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{class:"with-gap",name:"type",type:"radio",value:"outcome","onUpdate:modelValue":t[2]||(t[2]=e=>h.type=e)},null,512),[[o["vModelRadio"],h.type]]),Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(e.$t("common.outcome")),1)])]),Object(o["createElementVNode"])("div",r,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{id:"amount",type:"number",step:"any","onUpdate:modelValue":t[3]||(t[3]=e=>h.amount=e),class:Object(o["normalizeClass"])({invalid:j.v$.amount.$error})},null,2),[[o["vModelText"],h.amount,void 0,{number:!0}]]),Object(o["createElementVNode"])("label",s,Object(o["toDisplayString"])(e.$t("newRecord.amount")),1),j.v$.amount.$error?(Object(o["openBlock"])(),Object(o["createElementBlock"])("small",d,Object(o["toDisplayString"])(j.v$.amount.$errors[0].$message),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",b,[Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{id:"description",type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>h.description=e),class:Object(o["normalizeClass"])({invalid:j.v$.description.$error})},null,2),[[o["vModelText"],h.description]]),Object(o["createElementVNode"])("label",m,Object(o["toDisplayString"])(e.$t("newRecord.description")),1),j.v$.description.$error?(Object(o["openBlock"])(),Object(o["createElementBlock"])("small",u,Object(o["toDisplayString"])(j.v$.description.$errors[0].$message),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("button",p,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("newRecord.btnText"))+" ",1),O])],32)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",i,[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.$t("common.noCategories")),1),Object(o["createVNode"])(v,{to:"/categories"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.$t("common.addCategory")),1)]),_:1})]))])}var h=c("c3b3"),g=c("b9fb"),y=c("5502"),v=c("b444"),$={name:"Record",data(){return{loading:!0,categories:[],category:null,select:null,type:"outcome",amount:50,description:""}},setup(){return{v$:Object(h["a"])()}},validations:{amount:{required:g["b"].withMessage("Введите сумму",g["e"]),minValue:g["b"].withMessage(({$params:e})=>"Сумма должна быть не менее "+e.min,Object(g["d"])(50))},description:{required:g["b"].withMessage("Введите описание",g["e"])}},async mounted(){this.categories=await this.$store.dispatch("getCategories"),this.loading=!1,this.categories.length&&(this.category=this.categories[0].id),setTimeout(()=>{this.select=window.M.FormSelect.init(this.$refs.select),window.M.updateTextFields()},0)},computed:{...Object(y["c"])(["user"]),isCanAddRecord(){return"income"===this.type||this.user.bill>=this.amount}},methods:{async onSubmit(){if(this.v$.$validate(),!this.v$.$error){const e={categoryId:this.category,type:this.type,amount:this.amount,description:this.description,date:(new Date).toJSON()};if(this.isCanAddRecord)try{await this.$store.dispatch("addRecord",e);const t="income"===this.type?this.user.bill+this.amount:this.user.bill-this.amount;await this.$store.dispatch("updateUser",{bill:t}),this.$message(v["a"]["add-record"]),this.v$.$reset(),this.amount=50,this.description=""}catch{}else this.$error(`Недостаточно средств на счете (${this.amount-this.user.bill})`)}}},beforeUnmount(){this.select&&this.select.destroy&&this.select.destroy()}},V=c("6b0d"),w=c.n(V);const E=w()($,[["render",j]]);t["default"]=E},9703:function(e,t,c){"use strict";c.r(t);var o=c("7a23"),n=c("cb22"),i=c.n(n);const l={class:"center"},a=Object(o["createElementVNode"])("img",{src:i.a},null,-1);function r(e,t,c,n,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",l,[Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("strong",null,Object(o["toDisplayString"])(c.text||e.$t("common.404")),1)]),a])}var s={name:"NotFound",props:["text"]},d=c("6b0d"),b=c.n(d);const m=b()(s,[["render",r]]);t["default"]=m},cb22:function(e,t,c){e.exports=c.p+"img/404.4a06efb5.gif"}}]);
//# sourceMappingURL=record.d9a8bca1.js.map